services:
  mlflow:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: mlflow-server
    restart: unless-stopped
    ports:
      - "5001:5000"
    volumes:
      - mlflow-data:/data
    environment:
      - MLFLOW_FLASK_SERVER_SECRET_KEY=${SERVICE_PASSWORD_MLFLOW:-defaultsecret123}
      - MLFLOW_ADMIN_PASSWORD=${SERVICE_PASSWORD_64_MLFLOW_ADMIN:-password1234}
    command: >
      mlflow server
      --host 0.0.0.0
      --port 5000
      --backend-store-uri sqlite:///data/mlflow.db
      --default-artifact-root mlflow-artifacts:/
      --artifacts-destination /data/artifacts
      --serve-artifacts
      --allowed-hosts '*'
      --app-name basic-auth

volumes:
  mlflow-data:
